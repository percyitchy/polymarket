# ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Gamma API –≤ —Å–∏—Å—Ç–µ–º—É –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1Ô∏è‚É£ –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `gamma_client.py`

- ‚úÖ –§—É–Ω–∫—Ü–∏—è `get_event_by_slug(slug: str)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –ø–æ slug —á–µ—Ä–µ–∑ `/slug/{slug}`
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `get_event_by_condition_id(condition_id: str)` - –ø–æ–∏—Å–∫ —Å–æ–±—ã—Ç–∏—è –ø–æ condition_id —á–µ—Ä–µ–∑ `/events`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ –∏ non-200 —Å—Ç–∞—Ç—É—Å–æ–≤
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ –æ—à–∏–±–æ–∫
- ‚úÖ Fallback –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π URL –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ë–∞–∑–æ–≤—ã–π URL: `https://gamma-api.polymarket.com` (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `GAMMA_BASE_URL`)

### 2Ô∏è‚É£ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_get_price_from_gamma()` –≤ `price_fetcher.py`

- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –∑–∞–ø—Ä–æ—Å –ø–æ slug (–±—ã—Å—Ç—Ä–µ–µ)
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ø–æ–∏—Å–∫ –ø–æ condition_id —á–µ—Ä–µ–∑ `/events`
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏–∑ –ø–æ–ª—è `outcomePrices[outcome_index]`
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–æ–ª—è, —Ç–∏–ø–∞, –¥–ª–∏–Ω—ã –º–∞—Å—Å–∏–≤–∞)
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤

### 3Ô∏è‚É£ Gamma API –≤—Å—Ç—Ä–æ–µ–Ω –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω —Ü–µ–Ω

**–ù–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (6 —à–∞–≥–æ–≤):**
1. ‚úÖ Polymarket CLOB API /price (—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π)
2. ‚úÖ **Gamma API** (`/slug/{slug}` –∏–ª–∏ `/events`) ‚Üê **–ù–û–í–´–ô**
3. ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫ (data-api + clob)
4. ‚úÖ HashiDive API
5. ‚úÖ FinFeed API
6. ‚úÖ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∏–∑ wallet_prices (fail-open)

### 4Ô∏è‚É£ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è slug –≤ –≤—ã–∑–æ–≤—ã `get_current_price()`

- ‚úÖ `polymarket_notifier.py`: –ø–µ—Ä–µ–¥–∞—á–∞ `slug=market_slug` –≤ `_get_current_price()`
- ‚úÖ `notify.py`: –ø–µ—Ä–µ–¥–∞—á–∞ `slug=market_slug` –≤ `_get_current_price()`
- ‚úÖ `price_fetcher.py`: –ø–∞—Ä–∞–º–µ—Ç—Ä `slug` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `get_current_price()`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ tuple (—Ü–µ–Ω–∞, –∏—Å—Ç–æ—á–Ω–∏–∫) –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 5Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- ‚úÖ `API_PRICE_SOURCES.md`: –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª –ø—Ä–æ Gamma API
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ endpoints: `/slug/{slug}` –∏ `/events`
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª—è `outcomePrices` (0 = Yes, 1 = No)
- ‚úÖ –£–∫–∞–∑–∞–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –≤–æ–∑–º–æ–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ç–µ–ø–µ—Ä—å 10 API –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, 5 –æ—Å–Ω–æ–≤–Ω—ã—Ö)

### 6Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

- ‚úÖ `test_random_market_prices.py`: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ "gamma"
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è "Gamma" –≤–º–µ—Å—Ç–æ "gamma"
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º –≤–∫–ª—é—á–∞–µ—Ç Gamma

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `gamma_client.py` - –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Gamma API

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `price_fetcher.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_get_price_from_gamma()` –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ü–µ–ø–æ—á–∫—É
- `polymarket_notifier.py` - –ø–µ—Ä–µ–¥–∞—á–∞ `slug` –≤ `_get_current_price()`
- `notify.py` - –ø–µ—Ä–µ–¥–∞—á–∞ `slug` –≤ `_get_current_price()`
- `API_PRICE_SOURCES.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ Gamma API
- `test_random_market_prices.py` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ "gamma"

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤ –¥–ª—è Gamma API:

```
[PRICE_FETCH] Step 2/6: Gamma API
[PRICE_FETCH] [GAMMA] Trying Gamma API for condition_id=..., outcome_index=...
[PRICE_FETCH] [GAMMA] Trying to get event by slug: ...
[GAMMA] Requesting event by slug: ...
[GAMMA] Response status: 200
[PRICE_FETCH] [GAMMA] ‚úÖ Got price=0.952 from Gamma (outcomePrices[1])
```

–∏–ª–∏ –ø—Ä–∏ –æ—à–∏–±–∫–µ:

```
[PRICE_FETCH] [GAMMA] ‚ùå Failed to get price from Gamma: event not found
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

Gamma API –Ω–µ —Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–µ–π (–ø—É–±–ª–∏—á–Ω—ã–π API).

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±–∞–∑–æ–≤—ã–π URL —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
GAMMA_BASE_URL=https://gamma-api.polymarket.com
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ Gamma API –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ —à–∞–≥ 2/6 –≤ —Ü–µ–ø–æ—á–∫–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ü–µ–Ω
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–π API (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ –º–µ—Ç–æ–¥–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: –ø–æ slug (–±—ã—Å—Ç—Ä–µ–µ) –∏ –ø–æ condition_id
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–ª–æ–π –∑–∞—â–∏—Ç—ã**: Gamma API —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ CLOB/HashiDive/FinFeed –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
2. **–ü—É–±–ª–∏—á–Ω—ã–π API**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–µ–π
3. **–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø**: –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ slug –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ
4. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ï—â–µ –æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ —Ü–µ–Ω —Å–Ω–∏–∂–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å "—Ü–µ–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- Gamma API –º–æ–∂–µ—Ç –±—ã—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ—Ä–æ–Ω—Ç–æ–≤—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º (–º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ –æ—Ç—Å—Ç–∞–≤–∞—Ç—å –æ—Ç orderbook)
- –ï—Å–ª–∏ `gamma_client.py` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç Gamma –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫—É
- –í—Å–µ –æ—à–∏–±–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è gracefully, –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—è —Ü–µ–ø–æ—á–∫—É fallback

